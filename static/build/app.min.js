var wsRoomApp=angular.module("ws_room",["ngResource","ngRoute"]).constant("baseUrl","/api").config(["$routeProvider","$locationProvider",function(e,a){a.html5Mode(!0),e.when("/",{templateUrl:"app/start-page/startPage.html",controller:"startPageCtrl"}).when("/games",{templateUrl:"app/games-list/gamesList.html",controller:"gamesListCtrl"}).when("/games/:id",{templateUrl:"app/game-board/gameBoard.html",controller:"gameBoardCtrl"}).otherwise({redirectTo:"/"})}]);wsRoomApp.factory("$socket",["$rootScope",function(e){var a=io.connect();return{on:function(s,o){a.on(s,function(){var s=arguments;e.$apply(function(){o.apply(a,s)})})},emit:function(s,o,t){a.emit(s,o,function(){var s=arguments;e.$apply(function(){t&&t.apply(a,s)})})}}}]),wsRoomApp.factory("Users",["$resource","baseUrl",function(e,a){return e(a+"/users/:id:controller",{},{login:{method:"POST",params:{controller:"login"}},getLoggedIn:{method:"GET",params:{controller:"logged-in"}}})}]),wsRoomApp.factory("Games",["$resource","baseUrl",function(e,a){return e(a+"/games/:controller/:id",{id:"@id"},{create:{method:"POST",params:{controller:"create"}},reset:{method:"GET",params:{controller:"reset"}},connect:{method:"GET",params:{controller:"connect"}},query:{method:"GET",isArray:!0}})}]),wsRoomApp.directive("navBar",function(){return{scope:!0,templateUrl:"app/common/navBar.html"}}),wsRoomApp.service("UserService",["Users","$q",function(e,a){this.login=function(s){return e.login(s).$promise.then(function(e){return e.message?a.reject(e.message):e.user})},this.getLoggedIn=function(){return e.getLoggedIn().$promise.then(function(e){return e})}}]),wsRoomApp.controller("mainCtrl",["$scope","$rootScope","$location","UserService",function(e,a,s,o){o.getLoggedIn().then(function(a){a.id&&(e.user=a)}),a.$on("userUpdate",function(a,s){e.user=s})}]),wsRoomApp.controller("startPageCtrl",["$scope","$location","$rootScope","UserService",function(e,a,s,o){e.isFieldValid=function(a,s){var o=e.signInForm,t=o[a];return!o.$submitted||(s?!t.$error[s]:t.$valid)},e.loginUser=function(s){e.signInForm.$invalid||o.login({username:s.username}).then(function(s){e.$emit("userUpdate",s),a.path("/games")},function(a){e.message=a})}}]),wsRoomApp.controller("gamesListCtrl",["$scope","$socket","$location","Games",function(e,a,s,o){e.games=o.query(),e.waitingForOpponents=!1,e.newGameParams={size:"15"},a.on("games:createdNew",function(a){e.games.push(a)}),a.on("games:start",function(e){s.path("/games/"+e.gameId)}),e.createNewGame=function(){a.emit("games:create",e.newGameParams,function(){e.waitingForOpponents=!0})},e.connectToGame=function(s){a.emit("games:connect",s,function(a){e.message=a.message})}}]),wsRoomApp.controller("gameBoardCtrl",["$scope","$socket","$location","$routeParams","Games","UserService",function(e,a,s,o,t,n){n.getLoggedIn().then(function(a){a.id&&(e.user=a)});var l=o.id;t.get({id:l},function(a){e.game=a}),e.turn=function(s){var o={gameId:l,playerId:e.user.id,row:s.row,col:s.col};e.game.boardBlocked=!0,a.emit("games:turn",o,function(a){e.game.board=a.board})},a.on("games:turn",function(a){e.game.board=a.board,e.game.boardBlocked=!1})}]),angular.module("ws_room").run(["$templateCache",function(e){"use strict";e.put("app/common/navBar.html",'<nav class="navbar navbar-default" role="navigation"> <div class="container container-fluid"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="#">Dots</a> </div> <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li class="active"><a href="#">Game board</a></li> </ul> <ul class="nav navbar-nav navbar-right"> <li ng-if="user" class="active"><a href="#">{{user.username}}</a></li> <li ng-if="user" class="active"><a href="/logout">Logout</a></li> <li ng-if="!user" class="active"><a href="/login">Login</a></li> </ul> </div> </div> </nav>'),e.put("app/game-board/gameBoard.html",'<script src="gameFieldCtrl.js"><\/script> <div class="container"> <div class="row"> <div class="col-lg-7"> <div class="well"> <form class="form-inline"> <div class="form-group"> <label for="size">Size: </label> <select name="size" id="size" ng-model="game.size" class="form-control"> <option value="9">9 x 9</option> <option value="12">12 x 12</option> <option value="15">15 x 15</option> <option value="17">17 x 17</option> <option value="21">21 x 21</option> </select> </div> <button id="field-creator" class="btn btn-default" type="button">CREATE</button> <button id="reset-button" class="btn btn-default pull-right" type="button">RESET</button> </form> </div> </div> <div class="col-lg-5"> <div class="row"> <div class="col-lg-6"> <div class="panel panel-default"> <div class="panel-body"> <span>X-SCORE</span> </div> <div class="panel-footer"> <span id="x-score">0</span> </div> </div> </div> <div class="col-lg-6"> <div class="panel panel-default"> <div class="panel-body"> <span>O-SCORE</span> </div> <div class="panel-footer"> <span id="o-score">0</span> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="col-lg-7"> <div id="game-field-container"> <table id="game-field"> <tr ng-repeat="rows in game.board"> <td ng-repeat="cell in rows" ng-click="turn(cell)"> {{cell.value}} </td> </tr> </table> </div> </div> <div class="col-lg-5"> \x3c!-- Nav tabs --\x3e <ul class="nav nav-tabs" role="tablist"> <li role="presentation" class="active"> <a href="#home" aria-controls="home" role="tab" data-toggle="tab">Chat</a> </li> <li role="presentation"> <a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">History</a> </li> <li role="presentation"> <a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">Prefernces</a> </li> </ul> \x3c!-- Tab panes --\x3e <div class="tab-content g-tab-content"> <div role="tabpanel" class="tab-pane active" id="Chat"> <div class="chat-controls"> <div class="input-group well" id="typing-field"> <input type="text" class="form-control" placeholder="Enter Your messege"> <span class="input-group-btn"> <button class="btn btn-default" type="button">Send</button> </span> </div> </div> <div class="chat-messages-block"> <div class="chat-message-container"> <img class="chat-avatar" src="images/profile-photo.jpg"> <div class="chat-message-container"> <div class="chat-message my-messege">Hey. You juset reminded me my childhood. A speacially this game. I love it </div> <time class="chat-time">11:13</time> </div> <div class="chat-message-container"> <div class="chat-message my-messege"> Message 1 or maybe 2, I don\'t know honestly.<br> Lorem ipsum dollar ya lyublyu. </div> <time class="chat-time">11:14</time> </div> </div> <div class="chat-oponent-messege-container"> <div class="chat-message-container"> <div class="chat-message oponent-messege">What the heck Mark is coding?</div> <time class="chat-time">11:13</time> </div> <div class="chat-oponent-messege-container"> <div class="chat-message oponent-messege"> You know, sometimes he does well, but now.. </div> <time class="chat-time">11:14</time> </div> </div> </div> </div> <div role="tabpanel" class="tab-pane" id="History">...</div> <div role="tabpanel" class="tab-pane" id="Preferences">...</div> </div> </div> </div> </div>'),e.put("app/games-list/gamesList.html",'<div ng-if="!waitingForOpponents" class="row"> <div class="col-md-8"> <table class="table table-striped"> <tr ng-repeat="game in games"> <td>{{game.id}}</td> <td>{{game.login}}</td> <td>{{game.locked ? \'LOCKED\' : \'AVAILABLE\'}}</td> <td> <span class="glyphicon glyphicon-plus" ng-click="connectToGame(game.id)"></span> </td> </tr> </table> </div> <div class="col-md-4"> <div ng-if="message" class="alert alert-danger col-sm-offset-2 col-sm-10" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> {{message}} </div> <ng-form name="newGameForm"> <div class="form-group"> <label for="password">Password</label> <input id="password" class="form-control" type="password" placeholder="Game password for private game" ng-model="newGameParams.password"> </div> <div class="form-group"> <label for="size">Size: </label> <select name="size" id="size" ng-model="newGameParams.size" class="form-control"> <option value="9">9 x 9</option> <option value="12">12 x 12</option> <option value="15">15 x 15</option> <option value="17">17 x 17</option> <option value="21">21 x 21</option> </select> </div> <div class="form-group"> <button type="submit" class="btn btn-default" ng-click="createNewGame()">Create game</button> </div> </ng-form> </div> </div> <div ng-if="waitingForOpponents" class="row"> <div class="col-md-12"> <h2>Waiting for opponents...</h2> </div> </div> '),e.put("app/start-page/startPage.html",' <ng-form name="signInForm" class="form-horizontal md-form" autocomplete="off" novalidate> <div ng-if="message" class="alert alert-danger col-sm-offset-2 col-sm-10" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> {{message}} </div> <h1 class="form-title col-sm-offset-2 col-sm-10">Sign In</h1> <div class="form-group" ng-class="{\'has-error\': !isFieldValid(\'username\')}"> <label for="username" class="col-sm-2 control-label">Username</label> <div class="col-sm-10"> <input id="username" name="username" type="text" class="form-control form-control-danger" placeholder="Username" ng-model="user.username" minlength="2" maxlength="25" required> <span ng-if="!isFieldValid(\'username\', \'required\')" class="help-block">Username is required</span> <span ng-if="!isFieldValid(\'username\', \'minlength\')" class="help-block">Is too short</span> <span ng-if="!isFieldValid(\'username\', \'maxlength\')" class="help-block">Is too long</span> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-success" ng-click="loginUser(user)">Let\'s play</button> </div> </div> </ng-form>')}]);